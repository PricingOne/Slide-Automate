<!DOCTYPE html>
<html>
<head>
<title>doc.md</title>
<meta http-equiv="Content-type" content="text/html;charset=UTF-8">

<style>
/* https://github.com/microsoft/vscode/blob/master/extensions/markdown-language-features/media/markdown.css */
/*---------------------------------------------------------------------------------------------
 *  Copyright (c) Microsoft Corporation. All rights reserved.
 *  Licensed under the MIT License. See License.txt in the project root for license information.
 *--------------------------------------------------------------------------------------------*/

body {
	font-family: var(--vscode-markdown-font-family, -apple-system, BlinkMacSystemFont, "Segoe WPC", "Segoe UI", "Ubuntu", "Droid Sans", sans-serif);
	font-size: var(--vscode-markdown-font-size, 14px);
	padding: 0 26px;
	line-height: var(--vscode-markdown-line-height, 22px);
	word-wrap: break-word;
}

#code-csp-warning {
	position: fixed;
	top: 0;
	right: 0;
	color: white;
	margin: 16px;
	text-align: center;
	font-size: 12px;
	font-family: sans-serif;
	background-color:#444444;
	cursor: pointer;
	padding: 6px;
	box-shadow: 1px 1px 1px rgba(0,0,0,.25);
}

#code-csp-warning:hover {
	text-decoration: none;
	background-color:#007acc;
	box-shadow: 2px 2px 2px rgba(0,0,0,.25);
}

body.scrollBeyondLastLine {
	margin-bottom: calc(100vh - 22px);
}

body.showEditorSelection .code-line {
	position: relative;
}

body.showEditorSelection .code-active-line:before,
body.showEditorSelection .code-line:hover:before {
	content: "";
	display: block;
	position: absolute;
	top: 0;
	left: -12px;
	height: 100%;
}

body.showEditorSelection li.code-active-line:before,
body.showEditorSelection li.code-line:hover:before {
	left: -30px;
}

.vscode-light.showEditorSelection .code-active-line:before {
	border-left: 3px solid rgba(0, 0, 0, 0.15);
}

.vscode-light.showEditorSelection .code-line:hover:before {
	border-left: 3px solid rgba(0, 0, 0, 0.40);
}

.vscode-light.showEditorSelection .code-line .code-line:hover:before {
	border-left: none;
}

.vscode-dark.showEditorSelection .code-active-line:before {
	border-left: 3px solid rgba(255, 255, 255, 0.4);
}

.vscode-dark.showEditorSelection .code-line:hover:before {
	border-left: 3px solid rgba(255, 255, 255, 0.60);
}

.vscode-dark.showEditorSelection .code-line .code-line:hover:before {
	border-left: none;
}

.vscode-high-contrast.showEditorSelection .code-active-line:before {
	border-left: 3px solid rgba(255, 160, 0, 0.7);
}

.vscode-high-contrast.showEditorSelection .code-line:hover:before {
	border-left: 3px solid rgba(255, 160, 0, 1);
}

.vscode-high-contrast.showEditorSelection .code-line .code-line:hover:before {
	border-left: none;
}

img {
	max-width: 100%;
	max-height: 100%;
}

a {
	text-decoration: none;
}

a:hover {
	text-decoration: underline;
}

a:focus,
input:focus,
select:focus,
textarea:focus {
	outline: 1px solid -webkit-focus-ring-color;
	outline-offset: -1px;
}

hr {
	border: 0;
	height: 2px;
	border-bottom: 2px solid;
}

h1 {
	padding-bottom: 0.3em;
	line-height: 1.2;
	border-bottom-width: 1px;
	border-bottom-style: solid;
}

h1, h2, h3 {
	font-weight: normal;
}

table {
	border-collapse: collapse;
}

table > thead > tr > th {
	text-align: left;
	border-bottom: 1px solid;
}

table > thead > tr > th,
table > thead > tr > td,
table > tbody > tr > th,
table > tbody > tr > td {
	padding: 5px 10px;
}

table > tbody > tr + tr > td {
	border-top: 1px solid;
}

blockquote {
	margin: 0 7px 0 5px;
	padding: 0 16px 0 10px;
	border-left-width: 5px;
	border-left-style: solid;
}

code {
	font-family: Menlo, Monaco, Consolas, "Droid Sans Mono", "Courier New", monospace, "Droid Sans Fallback";
	font-size: 1em;
	line-height: 1.357em;
}

body.wordWrap pre {
	white-space: pre-wrap;
}

pre:not(.hljs),
pre.hljs code > div {
	padding: 16px;
	border-radius: 3px;
	overflow: auto;
}

pre code {
	color: var(--vscode-editor-foreground);
	tab-size: 4;
}

/** Theming */

.vscode-light pre {
	background-color: rgba(220, 220, 220, 0.4);
}

.vscode-dark pre {
	background-color: rgba(10, 10, 10, 0.4);
}

.vscode-high-contrast pre {
	background-color: rgb(0, 0, 0);
}

.vscode-high-contrast h1 {
	border-color: rgb(0, 0, 0);
}

.vscode-light table > thead > tr > th {
	border-color: rgba(0, 0, 0, 0.69);
}

.vscode-dark table > thead > tr > th {
	border-color: rgba(255, 255, 255, 0.69);
}

.vscode-light h1,
.vscode-light hr,
.vscode-light table > tbody > tr + tr > td {
	border-color: rgba(0, 0, 0, 0.18);
}

.vscode-dark h1,
.vscode-dark hr,
.vscode-dark table > tbody > tr + tr > td {
	border-color: rgba(255, 255, 255, 0.18);
}

</style>

<style>
/* Tomorrow Theme */
/* http://jmblog.github.com/color-themes-for-google-code-highlightjs */
/* Original theme - https://github.com/chriskempson/tomorrow-theme */

/* Tomorrow Comment */
.hljs-comment,
.hljs-quote {
	color: #8e908c;
}

/* Tomorrow Red */
.hljs-variable,
.hljs-template-variable,
.hljs-tag,
.hljs-name,
.hljs-selector-id,
.hljs-selector-class,
.hljs-regexp,
.hljs-deletion {
	color: #c82829;
}

/* Tomorrow Orange */
.hljs-number,
.hljs-built_in,
.hljs-builtin-name,
.hljs-literal,
.hljs-type,
.hljs-params,
.hljs-meta,
.hljs-link {
	color: #f5871f;
}

/* Tomorrow Yellow */
.hljs-attribute {
	color: #eab700;
}

/* Tomorrow Green */
.hljs-string,
.hljs-symbol,
.hljs-bullet,
.hljs-addition {
	color: #718c00;
}

/* Tomorrow Blue */
.hljs-title,
.hljs-section {
	color: #4271ae;
}

/* Tomorrow Purple */
.hljs-keyword,
.hljs-selector-tag {
	color: #8959a8;
}

.hljs {
	display: block;
	overflow-x: auto;
	color: #4d4d4c;
	padding: 0.5em;
}

.hljs-emphasis {
	font-style: italic;
}

.hljs-strong {
	font-weight: bold;
}
</style>

<style>
/*
 * Markdown PDF CSS
 */

 body {
	font-family: -apple-system, BlinkMacSystemFont, "Segoe WPC", "Segoe UI", "Ubuntu", "Droid Sans", sans-serif, "Meiryo";
	padding: 0 12px;
}

pre {
	background-color: #f8f8f8;
	border: 1px solid #cccccc;
	border-radius: 3px;
	overflow-x: auto;
	white-space: pre-wrap;
	overflow-wrap: break-word;
}

pre:not(.hljs) {
	padding: 23px;
	line-height: 19px;
}

blockquote {
	background: rgba(127, 127, 127, 0.1);
	border-color: rgba(0, 122, 204, 0.5);
}

.emoji {
	height: 1.4em;
}

code {
	font-size: 14px;
	line-height: 19px;
}

/* for inline code */
:not(pre):not(.hljs) > code {
	color: #C9AE75; /* Change the old color so it seems less like an error */
	font-size: inherit;
}

/* Page Break : use <div class="page"/> to insert page break
-------------------------------------------------------- */
.page {
	page-break-after: always;
}

</style>

<script src="https://unpkg.com/mermaid/dist/mermaid.min.js"></script>
</head>
<body>
  <script>
    mermaid.initialize({
      startOnLoad: true,
      theme: document.body.classList.contains('vscode-dark') || document.body.classList.contains('vscode-high-contrast')
          ? 'dark'
          : 'default'
    });
  </script>
<p>I can't create files directly for download, but I can provide you with the Markdown content. You can copy it into a text editor and save it as a <code>.md</code> file. Here’s the complete content for your documentation:</p>
<pre class="hljs"><code><div>---
marp: true
size: 4:3
style: |
  section {
<span class="hljs-code">    font-size: 9px; /* Base font size for the entire presentation */</span>
  }
  h1 {font-size: 18px; /<span class="hljs-emphasis">* Header 1 font size *</span>/
  line-height:0; /<span class="hljs-emphasis">* Set line height to 1 for tighter spacing *</span>/ }
  h2 {
<span class="hljs-code">    font-size: 16px; /* Header 2 font size */</span>
<span class="hljs-code">    line-height:0; /* Set line height to 1 for tighter spacing */ }</span>
  h3 {font-size: 14px; /<span class="hljs-emphasis">* Header 3 font size *</span>/ }
  p, li, code {
<span class="hljs-code">    font-size: 12px; /* Font size for paragraph, list items, and code */</span>
  }
<span class="hljs-section">  
---</span>
<span class="hljs-section"># Slide Automation Tool Documentation</span>

<span class="hljs-section">## Overview</span>
This documentation outlines the Slide Automation Tool, which utilizes Python to automate the creation of PowerPoint presentations based on cleaned data. The tool is structured into several sections, each focusing on different aspects of the slide generation process.

<span class="hljs-section">## Table of Contents</span>
<span class="hljs-bullet">- </span>[<span class="hljs-string">Landscape Section</span>](<span class="hljs-link">#landscape-section</span>)
<span class="hljs-bullet">- </span>[<span class="hljs-string">Pricing Section</span>](<span class="hljs-link">#pricing-section</span>)
<span class="hljs-bullet">- </span>[<span class="hljs-string">Project Steps</span>](<span class="hljs-link">#project-steps</span>)

---

<span class="hljs-section"># Landscape Section</span>

<span class="hljs-section">## Introduction</span>
In the slide automation landscape, we utilize 10 basic slides to create 22 sections. Here’s a breakdown of the sections:
<span class="hljs-bullet">
- </span>Market Trends by Manufacturer
<span class="hljs-bullet">- </span>Market Trends by Brands
<span class="hljs-bullet">- </span>Market Trends by Sectors
<span class="hljs-bullet">- </span>Market Trends by Segments
<span class="hljs-bullet">- </span>Market Concentration By Manufacturer
<span class="hljs-bullet">- </span>Market Concentration By Brands
<span class="hljs-bullet">- </span>Market Concentration By Sectors
<span class="hljs-bullet">- </span>Market Concentration By Segments
<span class="hljs-bullet">- </span>Market Growth By Sectors
<span class="hljs-bullet">- </span>Market Growth By Segments
<span class="hljs-bullet">- </span>Market Growth By Retailer For Region
<span class="hljs-bullet">- </span>Value Vs Avg Price By Sectors
<span class="hljs-bullet">- </span>Value Vs Avg Price By Segments
<span class="hljs-bullet">- </span>Value Vs Avg Price By Retailer For Region
<span class="hljs-bullet">- </span>Share and Growth By Manufacturer/Brands
<span class="hljs-bullet">- </span>Share And Growth By Manufacturer By Sector
<span class="hljs-bullet">- </span>Share And Growth By Brands By Sector
<span class="hljs-bullet">- </span>Share And Growth By Manufacturer By Segment
<span class="hljs-bullet">- </span>Share And Growth By Brands By Segment
<span class="hljs-bullet">- </span>Category Trends
<span class="hljs-bullet">- </span>Share Evolution By Brand
<span class="hljs-bullet">- </span>Category Overview

---

<span class="hljs-section">### Project Steps</span>
<span class="hljs-bullet">
- </span>Project Flow
![<span class="hljs-string">Project Flow</span>](<span class="hljs-link">&lt;../Slides Documentation/duplication_Steps.PNG&gt;</span>)
<span class="hljs-bullet">
1. </span>[<span class="hljs-string">Import Libraries</span>](<span class="hljs-link">#step-1-import-libraries</span>)
<span class="hljs-bullet">2. </span>[<span class="hljs-string">Clean DataFrames</span>](<span class="hljs-link">#step-2-clean-dataframes</span>)
<span class="hljs-bullet">3. </span>[<span class="hljs-string">Create Slides</span>](<span class="hljs-link">#step-3-create-slides</span>)
<span class="hljs-bullet">4. </span>[<span class="hljs-string">Duplicate Slides</span>](<span class="hljs-link">#step-4-duplicate-slides</span>)
<span class="hljs-bullet">5. </span>[<span class="hljs-string">Save Presentation</span>](<span class="hljs-link">#step-5-save-presentation</span>)

---

<span class="hljs-section"># [Step 1: Import Libraries](https://github.com/khaledSeifEleslam/Slide-Automate/blob/main/general_functions/generalFunctions.ipynb)</span>

<span class="hljs-code">```python
# Import necessary libraries for PowerPoint automation and data manipulation
from pptx import Presentation
import win32com.client as win32
import pandas as pd
import numpy as np
from pathlib import Path
import re
import sys
import time
import shutil
import os
import warnings

# Set default warnings to be ignored
warnings.filterwarnings("ignore")
</span></div></code></pre>
<hr>
<h1 id="step-2-clean-dataframes"><a href="https://github.com/khaledSeifEleslam/Slide-Automate/blob/main/Landscape%20slide%20duplicate/Landscape%20duplicate.ipynb">Step 2: Clean DataFrames</a></h1>
<pre class="hljs"><code><div><span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">clean_dataframes</span><span class="hljs-params">(df_dict)</span>:</span>
    <span class="hljs-string">"""
    Cleans a dictionary of DataFrames by filtering out unwanted rows and handling NaN values.
    
    Parameters:
        df_dict (dict): A dictionary containing DataFrames to clean.
    
    Returns:
        dict: A dictionary containing cleaned DataFrames.
    """</span>
    <span class="hljs-keyword">for</span> key <span class="hljs-keyword">in</span> df_dict.keys():
        df = df_dict[key].copy()  <span class="hljs-comment"># Create a copy to avoid modifying the original</span>
        df = df[df[<span class="hljs-string">'Top Brands'</span>] != <span class="hljs-string">'Others'</span>]  <span class="hljs-comment"># Filter out 'Others' rows</span>
        df = df.fillna(<span class="hljs-number">0</span>)  <span class="hljs-comment"># Replace NaN values with 0</span>
        df_dict[key] = df  <span class="hljs-comment"># Update the dictionary with the cleaned DataFrame</span>
    <span class="hljs-keyword">return</span> df_dict
</div></code></pre>
<hr>
<h1 id="step-3-create-slides"><a href="https://github.com/khaledSeifEleslam/Slide-Automate/blob/main/general_functions/Landscape%20Replacement%20Function.ipynb">Step 3: Create Slides</a></h1>
<pre class="hljs"><code><div><span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">create_price_positioning_slide</span><span class="hljs-params">(prs, modified_data, num_of_duplicates, position=<span class="hljs-number">0</span>)</span>:</span>
    <span class="hljs-string">"""
    Generates slides for price positioning analysis with bubble chart visualizations.
    
    Parameters:
        prs (Presentation): PowerPoint presentation object.
        modified_data (dict): Dictionary containing sorted price positioning DataFrames.
        num_of_duplicates (int): Number of duplicate slides to generate.
        position (int): Position index to start adding slides. Default is 0.
    """</span>
    <span class="hljs-keyword">for</span> slide_num <span class="hljs-keyword">in</span> range(num_of_duplicates):
        market = list(modified_data.keys())[slide_num]
        df = modified_data[market].reset_index(drop=<span class="hljs-literal">True</span>)  <span class="hljs-comment"># Reset index for the DataFrame</span>
        shapes = prs.slides[slide_num + position].shapes  <span class="hljs-comment"># Access slide shapes</span>
        charts = [shape <span class="hljs-keyword">for</span> shape <span class="hljs-keyword">in</span> shapes <span class="hljs-keyword">if</span> shape.has_chart]  <span class="hljs-comment"># Get all charts in slide</span>

        <span class="hljs-comment"># Update text boxes in the slide</span>
        shapes[<span class="hljs-number">4</span>].text = data_source  <span class="hljs-comment"># Assume data_source is defined elsewhere</span>
        shapes[<span class="hljs-number">5</span>].text = <span class="hljs-string">f'Brand Price &amp; Index vs Market | Bubble Size by Value Sales | <span class="hljs-subst">{market}</span> | P12M'</span>
        shapes[<span class="hljs-number">5</span>].text_frame.paragraphs[<span class="hljs-number">0</span>].font.bold = <span class="hljs-literal">True</span>
        
        <span class="hljs-keyword">if</span> charts:
            chart = charts[<span class="hljs-number">0</span>].chart  <span class="hljs-comment"># Assume there is at least one chart</span>
            chart_data = BubbleChartData()
            chart_data.categories = df[<span class="hljs-string">'Av Price/Unit'</span>].unique().tolist()
            series = chart_data.add_series(<span class="hljs-string">"Relative Price Index"</span>)
            series.has_data_labels = <span class="hljs-literal">True</span>
            
            <span class="hljs-comment"># Add data points to the bubble chart</span>
            <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> range(df.shape[<span class="hljs-number">0</span>]):
                series.add_data_point(df[<span class="hljs-string">'Av Price/Unit'</span>].iloc[i], df[<span class="hljs-string">'Relative Price'</span>].iloc[i], df[<span class="hljs-string">'Value Sales'</span>].iloc[i])
            chart.replace_data(chart_data)  <span class="hljs-comment"># Replace chart data</span>
</div></code></pre>
<hr>
<h1 id="step-4-duplicate-slides"><a href="https://github.com/khaledSeifEleslam/Slide-Automate/blob/main/Landscape%20slide%20duplicate/Landscape%20duplicate.ipynb">Step 4: Duplicate Slides</a></h1>
<pre class="hljs"><code><div><span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">prepare_slide_configuration</span><span class="hljs-params">(modified_data)</span>:</span>
    <span class="hljs-string">"""
    Prepares index and duplication lists for generating PowerPoint slides.
    
    Parameters:
        modified_data (dict): Dictionary containing modified DataFrames for slide generation.
    
    Returns:
        tuple: index list, duplication list, section names list
    """</span>
    index = [<span class="hljs-number">0</span>] * <span class="hljs-number">8</span>  <span class="hljs-comment"># Adjust according to your specific needs</span>
    duplication = [
        len(modified_data[<span class="hljs-string">'price_positioning'</span>]),  <span class="hljs-comment"># Example for price positioning slides</span>
        len(modified_data[<span class="hljs-string">'brand_segments'</span>]),      <span class="hljs-comment"># Example for segments leadership slides</span>
        <span class="hljs-comment"># Add more as needed...</span>
    ]
    
    <span class="hljs-comment"># Define section names based on duplication</span>
    section_names = [
        <span class="hljs-string">"Price Positioning Analysis"</span>,
        <span class="hljs-string">"Segments Leadership Analysis"</span>,
        <span class="hljs-comment"># Add more as needed...</span>
    ]
    
    <span class="hljs-keyword">return</span> index, duplication, section_names
</div></code></pre>
<hr>
<h1 id="step-5-save-presentation"><a href="https://github.com/khaledSeifEleslam/Slide-Automate/blob/main/Landscape%20slide%20duplicate/Landscape%20duplicate.ipynb">Step 5: Save Presentation</a></h1>
<pre class="hljs"><code><div><span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">save_presentation</span><span class="hljs-params">(prs, filename)</span>:</span>
    <span class="hljs-string">"""
    Saves the PowerPoint presentation and opens it using the PowerPoint application.
    
    Parameters:
        prs (Presentation): PowerPoint presentation object to save.
        filename (str): The filename to save the presentation as.
    """</span>
    output_path = os.path.join(os.getcwd(), filename)
    prs.save(output_path)  <span class="hljs-comment"># Save the presentation</span>
    app = win32.Dispatch(<span class="hljs-string">"PowerPoint.Application"</span>)  <span class="hljs-comment"># Initialize PowerPoint application</span>
    app.Presentations.Open(output_path)  <span class="hljs-comment"># Open the saved presentation</span>
</div></code></pre>
<hr>
<h1 id="pricing-section">Pricing Section</h1>
<h2 id="introduction">Introduction</h2>
<p>In the slide automation landscape using 8 basic slides, we have created 16 sections:</p>
<ul>
<li>Price Positioning Analysis</li>
<li>Segments Leadership Analysis</li>
<li>Sectors Leadership Analysis</li>
<li>Sector Avg Price/Vol Comparison</li>
<li>Sector Shelf Price/Vol Comparison</li>
<li>Segment Avg Price/Vol Comparison</li>
<li>Segment Shelf Price/Vol Comparison</li>
<li>Category Price Point Distribution Analysis P3M</li>
<li>Category Price Point Distribution Analysis P12M</li>
<li>Sector Price Point Distribution Analysis P3M</li>
<li>Sector Price Point Distribution Analysis P12M</li>
<li>Segment Price Point Distribution Analysis P3M</li>
<li>Segment Price Point Distribution Analysis P12M</li>
<li>Price Point Distribution Analysis By Brand</li>
<li>Price Point Distribution By Brand By Sector</li>
<li>Price Point Distribution By Brand By Segment</li>
</ul>
<hr>
<h3 id="project-steps">Project Steps</h3>
<ul>
<li>Project Flow
<img src="../Slides Documentation/duplication_Steps.PNG" alt="Project Flow">1. <a href="#step-1-import-libraries">Import Libraries</a>2. <a href="#step-2-clean-dataframes">Clean DataFrames</a>3. <a href="#step-3-create-slides">Create Slides</a>4. <a href="#step-4-duplicate-slides">Duplicate Slides</a>5. <a href="#step-5-save-presentation">Save Presentation</a>---# <a href="https://github.com/khaledSeifEleslam/Slide-Automate/blob/main/general_functions/generalFunctions.ipynb">Step 1: Import Libraries</a>(Include the same import code as above)---# <a href="https://github.com/khaledSeifEleslam/Slide-Automate/blob/main/Pricing%20slide%20duplicate/Pricing%20duplicate.ipynb">Step 2: Clean DataFrames</a>(Include the same cleaning code as above)---# Example: Input DataFrame Before Cleaning<img src="../Slides Documentation/Pricing dataframe input.png" alt="Data Frame Before Cleaning">---# Example: Market Trends Slide Output After Replacement Data<img src="../Slides Documentation/market trends output.png" alt="Market Trends Output">---```### Instructions to Create the File1. <strong>Copy the Markdown content</strong> above.2. <strong>Open a text editor</strong> (like Notepad, VSCode, or any Markdown editor).3. <strong>Paste the content</strong> into the editor.4. <strong>Save the file</strong> with a <code>.md</code> extension (for example, <code>slides_documentation.md</code>).If you need any more assistance or modifications, just let me know!</li>
</ul>

</body>
</html>
